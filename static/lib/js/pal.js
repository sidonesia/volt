function received_callback(data){$.ajaxSetup({beforeSend:function(x,settings){/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type)||x.setRequestHeader("X-CSRFToken",document.getElementsByName("_csrf_token")[0].value)}}),$.ajax({type:"POST",url:"/payments/callback",data:JSON.stringify(data),contentType:"application/json; charset=utf-8",async:!1,success:function(e){data=e.message_data,$(document).ajaxStop($.unblockUI),"COMPLETED"==data.status&&window.location.replace("/payment-thankyou?sess="+data.sess)}})}$("#payer_email").keypress((function(e){if(13==e.which)return!1})),$(document).ajaxStop($.unblockUI),paypal.Buttons({style:{label:"checkout",size:"medium",shape:"rect",color:"blue"},onInit:function(data,actions){actions.disable(),document.querySelector("#payer_email").addEventListener("change",(function(event){event.target.value?actions.enable():actions.disable()}))},onClick:function(){var email;document.querySelector("#payer_email").value?(document.querySelector("#msg").style.display="none",$.blockUI({css:{"font-size":"10px",border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.5,color:"#fff"}})):document.querySelector("#msg").style.display="block"},createOrder:function(data,actions){return actions.order.create({purchase_units:[{amount:{currency_code:"USD",value:document.querySelector("#billed_amount").value}}]})},onApprove:function(data,actions){return actions.order.capture().then((function(details){details.pid=document.querySelector("#pid").value,details.billed_amount=$("#billed_amount_tag").text().split(" ")[1],details.price=$("#price_tag").text().split(" ")[1],details.con_fee_usd=$("#convenience_fee_tag").text().split(" ")[1],details.price_idr=document.getElementById("price").value,details.convenience_fee=document.getElementById("convenience_fee").value,details.qty=1,details.tz=document.getElementById("tz").value,details.r_uri=document.getElementById("r_uri").value,details.iana=document.getElementById("iana").value,details.payer_email=document.getElementById("payer_email").value,received_callback(details)}))},onCancel:function(data){data.status="CANCELLED",data.payer_email=document.getElementById("payer_email").value,data.tz=document.getElementById("tz").value,details.iana=document.getElementById("iana").value,received_callback(data),$(document).ajaxStop($.unblockUI)}}).render("#paypal-container");