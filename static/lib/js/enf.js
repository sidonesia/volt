const image=document.getElementById("image");const fileCon=document.getElementById("pic");const editCon=document.querySelector("[data-edit-con]");const imgCon=document.querySelector("[data-img-con]");const imgInputCon=document.querySelector("[data-img-input]");const imgCon2=document.querySelector("#image");const g_compress=getConfig("G_IMAGE_CROP_COMPRESS",1);const g_cont_type=getConfig("G_IMAGE_CONTENT_TYPE","image/png");const g_crop_conf=getConfig("G_IMAGE_CROP_CONFIG",{minWidth:256,minHeight:256,maxWidth:4096,maxHeight:4096,fillColor:"#fff",imageSmoothingEnabled:true,imageSmoothingQuality:"high"});const g_thum_size=getConfig("G_IMAGE_THUM_SIZE1",{width:300,height:300});let counter=0;let _0x2c38=false;let myCropper;const rmList=[];for(var i=0;i<imgs.length;i++){var obj=imgs[i];counter=i+1;imgInputCon.classList.add("D(n)");loadImgE(obj.img,obj.id,counter)}document.getElementById("counter").value=counter;MicroModal.init({onClose:modal=>{myCropper&&myCropper.destroy()},onShow:modal=>{editCon.style.display="none"}});fileCon.addEventListener("click",e=>{if(myCropper){myCropper.destroy()}});fileCon.addEventListener("change",function(){const file=this.files[0];if(file&&file.type.startsWith("image/")){var FileSize=file.size/1024/1024;if(FileSize>5){alert("File size exceeds 5 MB")}else if(document.getElementById("counter").value==5){alert("you have reached the maximum limit for uploading images")}else{const reader=new FileReader;reader.readAsDataURL(file);reader.onload=e=>{imgCon2.setAttribute("src",e.target.result);editCon.style.display="block";myCropper=new Cropper(image,{autoCropArea:1,viewMode:3,zoomable:true,dragMode:"move",aspectRatio:1,background:false,ready:function(){this.cropper.crop()}})}}}});document.querySelector("#submitBtn").addEventListener("click",e=>{e.preventDefault();const croppedimage=myCropper.getCroppedCanvas(g_crop_conf).toDataURL(g_cont_type,g_compress);counter=counter+1;var newinput=document.createElement("input");newinput.type="hidden";newinput.id="unsaved_"+counter;newinput.name="pic_list";newinput.value=JSON.stringify({data:croppedimage,counter:counter});var newinput1=document.createElement("input");newinput1.type="hidden";newinput1.id="unsaved_"+counter+"_";newinput1.name="thumbnails";newinput1.value=JSON.stringify({data:myCropper.getCroppedCanvas(g_thum_size).toDataURL(g_cont_type,g_compress),counter:counter});document.getElementById("form").appendChild(newinput);document.getElementById("form").appendChild(newinput1);imgInputCon.classList.add("D(n)");loadImgE(croppedimage,"unsaved_"+counter);MicroModal.close("modal-2");fileCon.value=null});document.querySelector("#resetBtn").addEventListener("click",e=>{myCropper.reset()});function loadImgE(t,n,a){if(t){const o=`<div class="Pos(r) D(ib) Mx(2px)"><span title="Remove Image" id="${n}" data-counter="${a}" class="ri Pos(a) End(-3px) T(-6px) Fz(8px) D(ib) Py(3px) Px(6px) Bdrs(50%) Bgc(#ff7272) C(#ffffff) Cur(p) Scale(1.1):h">X</span><img style="height: 74px;width:74px"  class="Bdrs(4px) Ov(h)" src="${t}" alt=""></div>`;const i=document.querySelector("[data-img-con]");i.insertAdjacentHTML("afterbegin",o);let e=document.getElementById("counter").value;document.getElementById("counter").value=parseInt(e)+1}}imgCon.addEventListener("click",e=>{var count=document.getElementById("counter").value;const t=e.target;if(t.classList.contains("ri")){id=$(t).attr("id");id2=id+"_";count=count-1;counter=count;document.getElementById("counter").value=count;$(`input[id="${id}"]`).remove();$(`input[id="${id2}"]`).remove();t.parentElement.remove();if(id.split("_")[0]!="unsaved"){rmList.push(id)}imgInputCon.classList.remove("D(n)");fileCon.value=""}});const activeInput=document.querySelector("[data-active]");const starIcon=document.querySelector("[data-star]");activeInput.addEventListener("change",e=>e.target.checked?starIcon.style.fill="#ffc107":starIcon.style.fill="gray");const nfts=document.querySelectorAll("[data-nft]");const selectAll=document.querySelector("[data-select-all]");const submitBtn=document.querySelector("[data-submit]");const publicNft=document.querySelector("[data-public]");const privateNft=document.querySelector("[data-private]");const metamaskContainer=document.querySelector("[data-metamask]");const metamaskContainerBtn=document.querySelector("[data-metamaskc]");const userWallet=document.querySelector("#userWallet");const userWalletContainer=document.querySelector("[data-userWallet]");var _0x1b77=[];window.userWalletAddress=null;const loginButton=document.getElementById("loginButton");const importBtn=document.querySelector("[data-import]");importBtn.addEventListener("click",function(e){e.preventDefault();$(this).addClass("D(n)");$("#loaderWrap").removeClass("D(n)");setTimeout(function(){_0xdfa2()},200)});function showNftList(public,el){if(public&&el.checked){publicNft.classList.remove("D(n)");privateNft.classList.add("D(n)")}else{publicNft.classList.add("D(n)");privateNft.classList.remove("D(n)")}}function selectAllNft(el){if(el.checked){document.querySelectorAll("[data-nft]").forEach(nft=>{nft.checked=true})}else{document.querySelectorAll("[data-nft]").forEach(nft=>nft.checked=false)}}function hideSelected(el){const selected=document.querySelectorAll("[data-nft]:checked");const label=el.nextElementSibling;if(el.checked){label.textContent="Display Selected";selected.forEach(nft=>nft.closest(".col-6").classList.add("D(n)"))}else{label.textContent="Hide Selected";nfts.forEach(nft=>nft.closest(".col-6").classList.remove("D(n)"))}}window.addEventListener("DOMContentLoaded",()=>{viewNft()});function viewNft(){if(!isMetaMaskInstalled()){loginButton.innerText="MetaMask is not installed";loginButton.classList.remove("bg-purple-500","text-white");loginButton.classList.add("bg-gray-500","text-gray-100","cursor-not-allowed");return false}loginButton.addEventListener("click",connectToMetaMask)}function truncateAddress(address){if(!address){return""}return`${address.substr(0,5)}...${address.substr(address.length-5,address.length)}`}var _0x493d=["result","parse","userWalletAddress","data"];initialize();async function initialize(){const{ethereum}=window;const accounts=await ethereum.request({method:"eth_accounts"});if(accounts&&accounts.length>0&&localStorage.getItem("_x1")==1){window.userWalletAddress=accounts[0];userWalletContainer.classList.remove("D(n)");userWallet.innerText=`ETH Address: ${truncateAddress(window.userWalletAddress)}`;showNftListDisplay();$("[data-nft-list]").addClass("D(n)");$("[data-nft-loader").removeClass("D(n)");importBtn.classList.add("D(n)");$("#loaderWrap").removeClass("D(n)");_0xdfa2()}else{metamaskContainerBtn.classList.remove("D(n)");$("#loaderWrap0").addClass("D(n)")}_0x2c38=false}async function _0x7220(){const _0xd789=await ethereum.request({method:"wallet_requestPermissions",params:[{eth_accounts:{}}]});if(_0xd789){localStorage.setItem("_x1",1);if(!_0x2c38){_0x2c38=true;initialize()}submitBtn.disabled=true}}async function _0xdfa2(){$("[data-nft-list]").addClass("D(n)");{$("[data-nft-loader").removeClass("D(n)");const web3=new Web3(window.ethereum);let _0xfca5=[];postURL("/api/eth1",{_0xb2af:window[_0x493d[2]]}).done(function(e){_0xfca5=e[_0x493d[3]]});if(_0xfca5.length==0){$("[data-nft-list]").removeClass("D(n)");$("[data-nft-loader").addClass("D(n)")}const _0xb2af=[];for(const _0xa091 of _0xfca5){let _0xe843;postURL("/api/eth2",{_0xb2af:_0xa091._0x16f3}).done(function(e){_0xe843=e});if(_0xe843.status==1){const contract=new web3.eth.Contract(JSON.parse(_0xe843.result),_0xa091._0x16f3);for(i of _0xa091._0xc664){let o=await contract.methods.tokenURI(i._0x4b59).call();_0xb2af.push({data:o,i:i._0x4b59,_0x4f20:window.userWalletAddress})}}}postURL("/api/eth3",{_0xb2af:_0xb2af,_0xb319:_0x2466}).done(function(e){let j=0;_0x1b77=e.data;const list=document.getElementById("nfts");while(list.hasChildNodes()){list.removeChild(list.firstChild)}for(i of JSON.parse(e.data)){const eL=document.getElementById("nft_template").content.cloneNode(true);eL.querySelector("input").name="nft-"+j;eL.querySelector("input").checked=i.checked;eL.querySelector("input").id="nft-"+j;eL.querySelector("label").setAttribute("for","nft-"+j);eL.querySelector("img").src=i.image;eL.querySelector("p").innerText=i.name;document.getElementById("nfts").append(eL);j++}var zip=document.createElement("input");zip.type="hidden";zip.id="zip";zip.name="zip";zip.value=e.zip;document.getElementById("form").appendChild(zip);document.querySelectorAll("[data-nft]").forEach(nft=>{nft.addEventListener("change",e=>{if(!e.target.checked){selectAll.checked=false}})});$("[data-nft-loader").addClass("D(n)");$("[data-nft-list]").removeClass("D(n)");document.getElementById("nftCounter").innerText=JSON.parse(e.data).length;submitBtn.disabled=false;metamaskContainer.classList.add("D(n)");metamaskContainerBtn.classList.add("D(n)");$("[data-nft-container]").removeClass("D(n)")})}}function isMetaMaskInstalled(){return Boolean(window.ethereum&&window.ethereum.isMetaMask)}async function connectToMetaMask(){const _x1=localStorage.getItem("_x1")?localStorage.getItem("_x1"):0;if(_x1==0){_0x7220();return}const accounts=await window.ethereum.request({method:"eth_requestAccounts"})["catch"](e=>{return});if(!accounts){return}}function showNftListDisplay(){metamaskContainer.classList.add("D(n)");$("[data-nft-container]").removeClass("D(n)")}window.ethereum.on("accountsChanged",async e=>{if(!e[0]){signOutOfMetaMask();localStorage.setItem("_x1",0)}else{if(!_0x2c38){_0x2c38=true;initialize()}submitBtn.disabled=true;localStorage.setItem("_x1",1)}});function signOutOfMetaMask(){submitBtn.disabled=true;window.userWalletAddress=null;userWallet.innerText="";loginButton.innerText="Connect Now";userWalletContainer.classList.add("D(n)");metamaskContainer.classList.remove("D(n)");metamaskContainerBtn.classList.remove("D(n)");$("[data-nft-loader").addClass("D(n)");$("[data-nft-list]").addClass("D(n)");$("[data-nft-container]").addClass("D(n)");$("#loaderWrap0").addClass("D(n)")}$.validator.addMethod("special",function(e,t){return counter>0},"Please select a valid image.");$("#form").validate({ignore:"",onblur:true,onkeyup:false,onfocusout:function(element){this.element(element)},submitHandler:function(form){if(!$(".cbnft:checked").length>0){alert("Please select at least one NFT");return}document.querySelector(".loading").classList.remove("D(n)");$.each(rmList,function(index,val){var o=document.createElement("input");o.type="hidden";o.name="rmlist";o.value=val;document.getElementById("form").appendChild(o)});var params=$(form).serialize();$.ajax({type:"POST",url:"/process/nft/update",data:params+"&"+$.param({_0x1b77:JSON.stringify(_0x1b77)},true),success:function(response){var version_val=parseInt(navigator.appVersion);if(version_val>=4||window.location.replace){window.location.replace("/admin/my-lynks/home")}else{window.location.href="/admin/my-lynks/home"}}})},invalidHandler:function(form,validator){var errors=validator.numberOfInvalids();if(errors){$("html, body").animate({scrollTop:$(validator.errorList[0].element).offset().top-500},500)}}});$("#counter").rules("add",{required:true,special:true});$("#btn_dp").click(function(e){if(!confirm("Are you sure?")){e.preventDefault()}else{$("#form").attr("action","/process/nft/delete");document.getElementById("form").submit()}});